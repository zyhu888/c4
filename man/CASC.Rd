% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CASC.R
\name{CASC}
\alias{CASC}
\title{Covariate-Assisted Spectral Clustering (CASC)}
\usage{
CASC(Adj, Covariate, K, alphan = 5, itermax = 100, startn = 10)
}
\arguments{
\item{Adj}{An adjacency matrix of the network (symmetric, non-negative).}

\item{Covariate}{A node covariate matrix where rows correspond to nodes
and columns to covariates.}

\item{K}{The number of clusters to partition the nodes into (integer).}

\item{alphan}{Number of candidate \eqn{\alpha} values to evaluate. Default is 5.}

\item{itermax}{Maximum number of iterations for k-means. Default is 100.}

\item{startn}{Number of random starts for k-means. Default is 10.}
}
\value{
A list containing:
\item{cluster}{Cluster membership assignments for each node.}
\item{alpha}{The selected tuning parameter value.}
\item{alphalower}{Lower bound of the search range for \eqn{\alpha}.}
\item{alphaupper}{Upper bound of the search range for \eqn{\alpha}.}
}
\description{
Perform covariate-assisted spectral clustering (CASC) that integrates
network connectivity and node covariates. The method searches over a
range of tuning parameters (\eqn{\alpha}) to balance structural and
attribute information and selects the best clustering result.
}
\details{
CASC integrates adjacency information with covariate similarity by forming
a combined matrix \eqn{Z Z^\top + \alpha C}, where \eqn{Z} is the normalized
adjacency and \eqn{C} is the covariate similarity. The tuning parameter
\eqn{\alpha} is selected by minimizing within-cluster sum of squares.
}
\examples{
library(MASS)
set.seed(2)

# Generate covariates (200 nodes, 4 communities, 3 features per node)
# Each community has a different mean vector in 3D space
n <- 200; k <- 4; d <- 10; se <- 3
means <- matrix(c(
  d / sqrt(8),  d / sqrt(8),  d / sqrt(8),
  -d / sqrt(8), -d / sqrt(8),  d / sqrt(8),
  -d / sqrt(8),  d / sqrt(8), -d / sqrt(8),
  d / sqrt(8), -d / sqrt(8), -d / sqrt(8)
), nrow = 4, byrow = TRUE)
cov_matrix <- diag(se^2, 3)
community_sizes <- rep(n / k, k)

# Simulate multivariate normal features for each community
X <- do.call(rbind, lapply(1:k, function(c) {
  mvrnorm(community_sizes[c], means[c, ], cov_matrix)
}))

# Generate adjacency matrix from a weighted SBM
W <- gen_weighted_sbm(
  node_num = 200,
  cluster_size = rep(50, 4),
  win_cluster_den = 0.3,
  win_cluster_dist = "runif",
  win_cluster_par = list(min = 1, max = 2),
  btw_cluster_den = 0.2,
  btw_cluster_dist = "runif",
  btw_cluster_par = list(min = 1, max = 2)
)$adjacency_matrix

# Run CASC clustering
result_CASC <- CASC(W, X, K = 4)
result_CASC$cluster

}
\references{
Binkiewicz, N., Vogelstein, J. T., & Rohe, K. (2017).
Covariate-assisted spectral clustering. \emph{Biometrika}, 104(2), 361â€“377.
}
